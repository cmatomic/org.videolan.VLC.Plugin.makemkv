{
  "id": "org.videolan.VLC.Plugin.makemkv",
  "build-extension": true,
  "runtime": "org.videolan.VLC",
  "runtime-version": "stable",
  "branch": "3-19.08",
  "sdk": "org.freedesktop.Sdk//19.08",
  "tags": ["proprietary"],
  "separate-locales": false,
  "appstream-compose": false,
  "build-options": {
    "env": {
      "V": "1"
    }
  },
  "modules": [
    {
      "name": "wget",
      "no-autogen": true,
      "config-opts": [
        "--prefix=/app/share/vlc/extra/makemkv"
      ],
      "sources": [
        {
            "type": "archive",
            "url": "https://ftp.gnu.org/gnu/wget/wget-1.20.3.tar.gz",
            "sha256": "31cccfc6630528db1c8e3a06f6decf2a370060b982841cfab2b8677400a5092e"
        }
      ]
    },
    {
      "name": "makemkv-bin",
      "buildsystem": "simple",
      "build-commands": [
        "mkdir -p tmp",
        "echo accepted > tmp/eula_accepted",
        "make PREFIX=/app/share/vlc/extra/makemkv install",
        "install -Dp -m 644 src/eula_en_linux.txt --target-directory=/app/share/vlc/extra/makemkv/share/licenses"
      ],
      "sources": [
        {
          "type": "archive",
          "url": "http://www.makemkv.com/download/makemkv-bin-1.14.7.tar.gz",
          "sha256": "b66c676a32aa776635c56ad0193f8e3857791c02a10c48d1d85b4134fd1646a6"
        }
      ]
    },
    {
      "name": "makemkv-oss",
      "config-opts": [
        "--with-pic",
        "--enable-shared",
        "--disable-static",
        "--disable-gui",
        "DESTDIR=/",
        "--prefix=/app/share/vlc/extra/makemkv"
      ],
      "post-install": [
        "install -Dp -m 644 License.txt --target-directory=/app/share/vlc/extra/makemkv/share/licenses",
        "install -Dp -m 644 org.videolan.VLC.Plugin.makemkv.appdata.xml --target-directory=${FLATPAK_DEST}/share/appdata",
        "appstream-compose --basename=org.videolan.VLC.Plugin.makemkv --prefix=${FLATPAK_DEST} --origin=flatpak org.videolan.VLC.Plugin.makemkv"
      ],
      "sources": [
        {
          "type": "archive",
          "url": "http://www.makemkv.com/download/makemkv-oss-1.14.7.tar.gz",
          "sha256": "a95cb77030851138df0b936f2a2cf01f4b48b5a1a02a4599d82d3c073723cbf0"
        },
        {
          "type": "patch",
          "path": "makemkv-oss-wget.patch"
        },
        {
          "type": "file",
          "path": "org.videolan.VLC.Plugin.makemkv.appdata.xml"
        }
      ]
    },
    {
      "name": "envvars",
      "buildsystem": "simple",
      "build-commands": [
        "mv makemkv-env.sh /app/share/vlc/extra/makemkv"
      ],
      "sources": [
        {
          "type": "file",
          "path": "makemkv-env.sh"
        }
      ]
    }
  ]
}
